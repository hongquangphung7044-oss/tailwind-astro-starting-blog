IMAGE_REPO_DIR="$HOME/blog-images" --- title: "cat > 
~/publish_blog.sh <<'EOF'" date: "2026-02-22 16:19:35" summary: 
"äº’è”ç½‘çš„ä¸€è§’" cover: "../../assets/default-cover.png" tags: 
["#!/bin/bash"] --- LOCAL_ASSETS_DIR="src/assets" 
DEFAULT_COVER_REF="../../assets/default-cover.png" 
GITHUB_USER="hongquangphung7044-oss" IMAGE_REPO="blog-images"
# --- è¾…åŠ©å‡½æ•°ï¼šç”Ÿæˆæ–‡ç« åˆ—è¡¨å¹¶æ ¡éªŒåºå· ---
get_files() { files=($(ls $BLOG_DIR/src/content/blog/*.md | 
    sort -r)) [ ${#files[@]} -eq 0 ] && echo "âŒ 
    ç›®å½•ä¸‹æ²¡æœ‰æ–‡ç« " && exit 1 declare -gA file_map i=1 for file 
    in "${files[@]}"; do
        title=$(grep "^title:" "$file" | head -n 1 | sed 
        's/title: //g' | tr -d '"') file_map[$i]=$file printf 
        "[%2d] %s\n" $i "$title" ((i++))
    done max_idx=$((i-1))
}
# --- c æ¨¡å¼ï¼šæ›´æ–°é»˜è®¤å°é¢ ---
if [ "$1" == "c" ]; then read -p "[é’¦å®š] è¾“å…¥æ–°é»˜è®¤å°é¢å…³é”®è¯: 
    " c_kw found=$(find /sdcard/Pictures /sdcard/DCIM 
    /sdcard/Download -iname "*$c_kw*" -print -quit 2>/dev/null) 
    if [ -n "$found" ]; then
        cp "$found" "$BLOG_DIR/src/assets/default-cover.png" cd 
        "$BLOG_DIR" && git add . && git commit -m "Update 
        default cover" && git push echo "âœ… é»˜è®¤å°é¢å·²æ›´æ–°" && 
        ~/check_cf.sh
    else echo "âŒ æœªæ‰¾åˆ°å…³é”®è¯ç›¸å…³çš„å›¾ç‰‡"; fi exit fi
# --- _ æ¨¡å¼ï¼šæ‰¹é‡åˆ é™¤ ---
if [ "$1" == "_" ]; then get_files read -p "[åˆ é™¤] è¾“å…¥åºå·: " 
    choice if [[ "$choice" -gt 0 && "$choice" -le "$max_idx" 
    ]]; then
        rm -f "${file_map[$choice]}" cd "$BLOG_DIR" && git add 
        -A && git commit -m "Delete article" && git push 
        ~/check_cf.sh
    else echo "âŒ åºå· $choice è¶Šç•Œäº†ï¼Œç›®å‰åªæœ‰ 1-$max_idx"; fi 
    exit
fi
# --- e æ¨¡å¼ï¼šç¼–è¾‘æ–‡ç«  ---
if [ "$1" == "e" ]; then get_files read -p "[ç¼–è¾‘] è¾“å…¥åºå·: " 
    choice if [[ "$choice" -gt 0 && "$choice" -le "$max_idx" 
    ]]; then
        nano "${file_map[$choice]}" cd "$BLOG_DIR" && git add . 
        && git commit -m "Edit article" && git push 
        ~/check_cf.sh
    else echo "âŒ åºå· $choice è¶Šç•Œäº†ï¼Œè¾“å…¥ä¸ªå¯¹çš„ï¼"; fi exit 
fi
# --- p æ¨¡å¼ï¼šå›¾åºŠç®¡ç† ---
if [ "$1" == "p" ]; then read -p "[å›¾åºŠ] å…³é”®è¯ (ç©ºæ ¼éš”å¼€): " 
    kws links="" for kw in $kws; do
        found=$(find /sdcard/Pictures /sdcard/DCIM 
        /sdcard/Download -iname "*$kw*" -print -quit 
        2>/dev/null) if [ -n "$found" ]; then
            img_name=$(basename "$found") cp "$found" 
            "$IMAGE_REPO_DIR/" links="${links}![]($img_name)\n"
        fi done cd "$IMAGE_REPO_DIR" && git add . && git commit 
    -m "Upload images" && git push echo -e "\n\e[33mðŸš€ å›¾ç‰‡é“¾æŽ¥ 
    (ç›´æŽ¥å¤åˆ¶åˆ°åšå®¢):\e[0m\n$links" exit
fi
# --- + æ¨¡å¼ï¼šå‘å¸– (åŠ¨æ€æ ‡ç­¾æ”¯æŒ) ---
if [ "$1" == "+" ] || [ -z "$1" ]; then cd "$BLOG_DIR" || exit 
    read -p "[1/4] æ ‡é¢˜: " title read -p "[2/4] æ ‡ç­¾ 
    (é€—å·éš”å¼€ï¼Œå¦‚: æµ‹è¯•,æ—¥å¸¸): " tags_raw read -p "[3/4] 
    å°é¢å…³é”®è¯: " kw
    # æ ‡ç­¾å¤„ç†ï¼šè½¬ä¸º ["æ ‡ç­¾1", "æ ‡ç­¾2"] æ ¼å¼
    [ -z "$tags_raw" ] && tags_raw="éšç¬”" formatted_tags=$(echo 
    $tags_raw | sed 's/,/","/g' | sed 's/ï¼Œ/","/g') 
    final_tags="[\"$formatted_tags\"]"
    # å°é¢å¤„ç†
    if [ -z "$kw" ]; then cover_line="\"$DEFAULT_COVER_REF\"" 
    else
        found=$(find /sdcard/Pictures /sdcard/DCIM 
        /sdcard/Download -iname "*$kw*" -print -quit 
        2>/dev/null) if [ -n "$found" ]; then
            img_name=$(basename "$found") cp "$found" 
            "$LOCAL_ASSETS_DIR/$img_name" 
            cover_line="\"../../assets/$img_name\""
        else cover_line="\"$DEFAULT_COVER_REF\""; fi fi 
    filename="src/content/blog/$(date +%Y%m%d%H%M).md" echo -e 
    "---\ntitle: \"$title\"\ndate: \"$(date +'%Y-%m-%d 
    %H:%M:%S')\"\nsummary: \"äº’è”ç½‘çš„ä¸€è§’\"\ncover: 
    $cover_line\ntags: $final_tags\n---" > "$filename" echo -e 
    "\e[32m[4/4] æ­£æ–‡å†…å®¹...\e[0m" && sleep 1 && nano 
    "$filename" git add . && git commit -m "Post: $title" && 
    git push ~/check_cf.sh exit
fi EOF chmod +x ~/publish_blog.sh
